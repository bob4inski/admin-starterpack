CPU -> 0xff -> BIOS/UEFI


EBR ?

1. Процессор запускается с участка кода, который ведет на BIOS
Сам биос:
- запускает POST -  чекает все оборудование
- смотрит на разметку дисков (MBR/GPT) и ищет устройство с которого можно загрузиться `efibootmgr -v`
- на дисках есть загрузочный сектор в котором есть небольшой код какого-то загрузчика

2. POST - самотестирование оборудования, если что-то сломалось - то может пойти пищать или моргать если есть индикация
3. После того, как у нас все компоненты прошли тесты - необходимо уже запускать загрузчик
Но у нас же может быть несколько дисков на системе, и как тогда понять откуда грузиться? Когда вы ставили на сам ноут вторую операционку, то иногда нужно явно в биосе сказать, что приоритет у флешки будет 0 и мы пойдем смотреть загрузчик уже там
Что касается EFI - то там на дисках есть специальный раздел, в который посмотрит UEFI
efibootmgr -v

4. Разметка дисков/MBR/GPT
MBR - Master boot record (512 bytes)
оперируем только номером диска

GPT - ~64kb
Уникальные GUID на диски

5. Загрузчики

Знаете ли вы какие-то загрузчики? (grub а что еще есть?)

    - В конфиге/загрузчике можно увидеть загрузочные записи откуда мы будем запускать Ядро линукса
    - Тк все находится на системе, то вы можете посмотреть у себя конфиг граба
    ```bash
    grep menuentry  /boot/grub/grub.cfg
    efibootmgr -v
    ```

7. Что такое initrd/initramfs и vmlinuz/kernel

vmlinuz - сжатый kernel
kernel - бинарник

initramfs - буквально инит файловой системы в памяти
Это набор модулей который нужен для загрузки файловой системы (к примеру модули в )

6. Порядок загрузки в grub like

Внимательнее посмотреть на grub.cfg и посмотреть какие модули подргружаются


8. Дебаг проблем dmesg/syslog


# TLDR
BIOS (запускается какая-то программка) -> Проверяется железо -> ищем загрузчик -> загрузчик инициализирует все модули -> инициализируется ядро -> инит systemd -> инициализируется nginx


Ядро Linux (kernel)
- компилируется ядро
- монтируется initramfs и распаковывается все файловая система
- запускается init скрипт, который управляем всей системой

-------------
3. Что такое Init?
Исходно задача init - управлять процессами
У нас есть:
- systemd
- openrc
- runit
- и какая-то бла бла

А еще можно сделать свой кастомный скрипт, передать в ядро агрумент запуска init и будет просто ваш скриптик

Но так получилось, что практически везде используется systemd
Systemd это и плюс и минус, но для домашнего использования вообще без разницы какой init будет, он не принесет проблем
Как можно посмотреть какой у вас init - `pstree`

В systemd у нас есть сервисы `systemctl list-unit-files`
К примеру если мы базово ставим nginx - то можно глянуть что запускается при старте



-----------------

#### Диски

1. Как стоит рассматривать каждый диск?
один диск - одна гусеница с кучей данных

2. Сколько есть разных файловых систем

2. Как написать свою файловую




4. Типы файловых систем

- procfs
- tmpfs
- /run /var/run

3. man hier
Основные папки:
- /etc
- /tmp
- /var/log
- /usr/bin
- /usr/shared


4. Файлы и inode
Привести пример с удалением файла на лету (но на маке не получится)
Что произойдет если закончатся inode?

5. Текущие диски, точки монтирования, fstab

как посмотреть текущие диски в системе
как посмотреть текущие точки монтирования

Что такое fstab

6. Разметка дисков fdisk/gdisk
Как правильно переразметить диск
Можно ли увеличить размер / ?

7. Проверка состояния дисков

fsck
smartctl

8. Raid массивы - mdadmd
не типы, а как их строить

### Домашка по итогу лекций
Установить виртуалку в arch, но сделать так, чтобы /boot раздел лежал на raid 1




