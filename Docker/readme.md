# Docker
Спрашиваю работали ли они с докером + docker compose и что им следует его себе прямо сейчас поставить на убунту (иначе будет жопа с отладкой ну или у кого мак - там проще): (но сначала спросить кто не знает про докер вообще)
Контейнер это не виртуалка, если кто-то скажет обратное - модете смело меня поправлять

### Что такое докер, и зачем он нужен?
Вступление в лекцию: вот у вас есть какое-то рабочее приложение - nginx к примеру
И вам нужно потом его где-то развернуть в изолированном окржении

И тут есть 2 варианта (а еще у вас где-то на собесе будут спрашивать в чем отличия):
- контейнеризация
- виртуализация


## контейнеризация
Что такое контейнеризация?
Технология позволяющая запускать процессы в изолированном окружении на Ядре хостовой машины (мы изолируем ресурсы которые может использовать процесс)

Она реализуется только за счет механизмом ядра Linux:
То есть на Винде когда мы ставим docker, то внутри все равно используется что-то, что может запустить мини-линукс в винде (wsl)
- Cgroups (Органичение количественное)
- Namespaces (Область видимости процесса)

Какие есть ресурсы у ноута/сервера?
CPU/RAM/disk/NET

К примеру я хочу явно сказать - вот ты, используй 1 CPU, 126 mb оперативки и вот такую сетку

Вы используете какой-то Container Runtime:
    1. Docker
    2. containerd
    3. CRI-0

- виртуализация (Полностью изолированы от OS, виртуалка думает что она и есть железка)
Запускаем полноценную машинку, которая думает что у нее есть прямой доступ до ресурсов хоста
То есть у нас запускается полностью init, ядро грузится, все как на обычном хосте


- Чем контейнер от виртуалки отличается, как понять что я внутри докера или виртуалки? (тут подготовить консольку с докером и виртуалкой)
Показать вот тут 2 консои в сплит экране с ubuntu и контейнером ubuntu

### база докера, основные сущности
0. Синтаксис
Какие у нас есть команды и какие чаще всего используются (https://docs.docker.com/reference/dockerfile/)
```Dockerfile
FROM ubuntu:24.04 as base
RUN
COPY
CMD
```

1. Докер собирается по слоям, каждая строчка в Dockerfile это новый слой
Слои переиспользуются при каждой сборке, поэтому надо выносить самые тяжелые/долгие операции наверх файлика
Что будет
- правила написания
    Практика: Большое задание по nginx в докере + для умных сделать SSL

- быстрый гайд по правилам написания докерфайла
- Фиксировать версии
- Правильное переиспользование слоев (что такое слои)
- как правильно использовать порты docker
- какие есть сети в докере


---
### Практика (чеклист):
1. Базовая работа с docker
    - Установить Docker на linux
    - Запустить какой-то hello world
    - базово запустить любой nginx образ в docker
    - Не изменя в конфиге nginx запустить контейнер с другим портом (перефразировать)
    - Научиться работать с volume в докере:
        - Во время запуска контейнера подложить конфигурационный файл
        - Смонтировать папку на своем хосте в папку с логами внутри контейнера
        Надо сделать так, чтобы можно было
    - Конфигурационный файл nginx должен подкладываться во сборки

2. docker-compose
    1. Собрать 1 задание полностью через docker-compose
    2. 
---

### Docker help
```bash
docker pull nginx
docker pull alpine:latest
docker build --tag my-nginx:version
docker run --interactive --tag my-nginx:version <команда которую хотим запустить>
# лучше сократить до docker run -it my-nginx:version bash
docker
```
